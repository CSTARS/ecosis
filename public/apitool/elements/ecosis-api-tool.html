<dom-module id="ecosis-api-tool">
  <template>

    <div id="btns">
      <a class="btn btn-default" id="package" href="#package/query">Package</a>
      <a class="btn btn-default" id="spectra" href="#spectra/query">Spectra</a>
    </div>

    <div style="padding: 10px">
      <ecosis-package-api panel root-package>
        <ecosis-package-query panel></ecosis-package-query>
      </ecosis-package-api>

      <ecosis-spectra-api panel root-spectra>
        <ecosis-spectra-query panel></ecosis-spectra-query>
      </ecosis-spectra-api>
    </div>

  </template>
</dom-module>

<script>
  Polymer({
    is : 'ecosis-api-tool',

    ready : function() {
      $(window).on('hashchange', this.updatePanel.bind(this));
    },

    attached : function() {
      this.updatePanel();
    },

    updatePanel : function() {
      var hash = window.location.hash.replace(/#/,'').split('/');

      var root = 'package',
          api = 'query';

      if( hash.length > 0 && hash[0] != "") {
        root = hash[0];
        if( hash.length > 1) {
          api = hash[1]
        }
      }

      $(this).find('[panel]').hide();
      $(this.$.btns).find('a').removeClass('btn-primary').addClass('btn-default');

      $(this).find('[root-'+root+']').css('display', 'block')[0].setTab(api);
      $(this)
        .find('ecosis-'+root+'-'+api)
        .css('display', 'block');

      if( this.$[root] ) {
        this.$[root].className = 'btn btn-primary';
      }
    }

  });
</script>
